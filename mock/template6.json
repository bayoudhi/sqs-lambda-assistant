{
  "Resources": {
    "SQSQueue1": {
      "Type": "AWS::SQS::Queue"
    },
    "SQSQueue2": {
      "Type": "AWS::SQS::Queue"
    },
    "LambdaFunction1": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Handler": "index.handler",
        "Role": "arn:aws:iam::123456789012:role/lambda-role",
        "FunctionName": "LambdaFunction1",
        "Runtime": "nodejs14.x",
        "Code": {
          "S3Bucket": "lambda-code-bucket",
          "S3Key": "lambda-code1.zip"
        },
        "Environment": {
          "Variables": {
            "QUEUE_URL": { "Ref": "SQSQueue1" }
          }
        }
      }
    },
    "LambdaFunction2": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Handler": "index.handler",
        "Role": "arn:aws:iam::123456789012:role/lambda-role",
        "FunctionName": "LambdaFunction2",
        "Runtime": "nodejs14.x",
        "Code": {
          "S3Bucket": "lambda-code-bucket",
          "S3Key": "lambda-code2.zip"
        },
        "Environment": {
          "Variables": {
            "QUEUE_URL": { "Ref": "SQSQueue2" }
          }
        }
      }
    },
    "CloudWatchAlarm1": {
      "Type": "AWS::CloudWatch::Alarm",
      "Properties": {
        "ActionsEnabled": true,
        "AlarmDescription": "Alarm for LambdaFunction1 errors",
        "MetricName": "Errors",
        "Namespace": "AWS/Lambda",
        "Statistic": "Sum",
        "Threshold": 1,
        "ComparisonOperator": "GreaterThanOrEqualToThreshold",
        "EvaluationPeriods": 1,
        "Period": 300,
        "Dimensions": [
          {
            "Name": "FunctionName",
            "Value": { "Ref": "LambdaFunction1" }
          }
        ]
      }
    },
    "CloudWatchAlarm2": {
      "Type": "AWS::CloudWatch::Alarm",
      "Properties": {
        "ActionsEnabled": true,
        "AlarmDescription": "Alarm for LambdaFunction2 errors",
        "MetricName": "Errors",
        "Namespace": "AWS/Lambda",
        "Statistic": "Sum",
        "Threshold": 1,
        "ComparisonOperator": "GreaterThanOrEqualToThreshold",
        "EvaluationPeriods": 1,
        "Period": 300,
        "Dimensions": [
          {
            "Name": "FunctionName",
            "Value": { "Ref": "LambdaFunction2" }
          }
        ]
      }
    }
  }
}
